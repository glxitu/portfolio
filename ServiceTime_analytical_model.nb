(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 8.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       157,          7]
NotebookDataLength[     35900,        886]
NotebookOptionsPosition[     35452,        868]
NotebookOutlinePosition[     35912,        886]
CellTagsIndexPosition[     35869,        883]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
     RowBox[{
     "Caracteriza\[CCedilla]\[ATilde]o", " ", "do", " ", "tempo", " ", "de", 
      " ", "servi\[CCedilla]o"}], " ", "-", " ", 
     RowBox[{"fun\[CCedilla]\[ATilde]o", " ", "caracter\[IAcute]stica"}]}], 
    ",", " ", 
    RowBox[{
     RowBox[{
     "fun\[CCedilla]\[ATilde]o", " ", "de", " ", 
      "distribui\[CCedilla]\[ATilde]o", " ", "acumulada", " ", "e", " ", 
      "fun\[CCedilla]\[ATilde]o", " ", "densidade", " ", "da", " ", 
      "probabilidade"}], " ", "-", 
     RowBox[{
     "de", " ", "um", " ", "canal", " ", "de", " ", "uso", " ", "licenciado", 
      " ", "com", " ", "utiliza\[CCedilla]\[ATilde]o", " ", "baseada", " ", 
      "em", " ", "distribui\[CCedilla]\[OTilde]es", " ", 
      RowBox[{"geom\[EAcute]tricas", "."}]}]}]}], " ", "*)"}], " ", 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"ClearAll", "[", "\"\<Global`*\>\"", "]"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"Mean", " ", "Length", " ", "Variable"}], "*)"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"pLength", "=", 
     RowBox[{"1", "/", "meanLength"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"pON", "=", 
     RowBox[{"1", "/", "meanON"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"pOFF", "=", 
     RowBox[{"1", "/", "meanOFF"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"fLength", ":=", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"k", "<", "1"}], ",", "0", ",", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "/", "meanLength"}], ")"}], "*", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "-", 
           RowBox[{"(", 
            RowBox[{"1", "/", "meanLength"}], ")"}]}], ")"}], "^", 
         RowBox[{"(", 
          RowBox[{"k", "-", "1"}], ")"}]}]}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"DiscretePlot", "[", 
     RowBox[{"fLength", ",", 
      RowBox[{"{", 
       RowBox[{"k", ",", "1", ",", "10"}], "}"}]}], "]"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"fON", ":=", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"k", "<", "1"}], ",", "0", ",", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "/", "meanON"}], ")"}], "*", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "-", 
           RowBox[{"(", 
            RowBox[{"1", "/", "meanON"}], ")"}]}], ")"}], "^", 
         RowBox[{"(", 
          RowBox[{"k", "-", "1"}], ")"}]}]}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"DiscretePlot", "[", 
     RowBox[{"fON", ",", 
      RowBox[{"{", 
       RowBox[{"k", ",", "1", ",", "10"}], "}"}]}], "]"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"fOFF", ":=", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"k", "<", "1"}], ",", "0", ",", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "/", "meanOFF"}], ")"}], "*", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "-", 
           RowBox[{"(", 
            RowBox[{"1", "/", "meanOFF"}], ")"}]}], ")"}], "^", 
         RowBox[{"(", 
          RowBox[{"k", "-", "1"}], ")"}]}]}]}], "]"}]}], ";"}], "\n", 
   RowBox[{"(*", 
    RowBox[{"DiscretePlot", "[", 
     RowBox[{"fOFF", ",", 
      RowBox[{"{", 
       RowBox[{"k", ",", "1", ",", "10"}], "}"}]}], "]"}], "*)"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"fOFF2", "[", "r_", "]"}], "=", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"k", "\[GreaterEqual]", "r"}], ",", 
       RowBox[{
        RowBox[{"Binomial", "[", 
         RowBox[{
          RowBox[{"k", "-", "1"}], ",", 
          RowBox[{"r", "-", "1"}]}], "]"}], "*", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "/", "meanOFF"}], ")"}], "^", 
         RowBox[{"(", "r", ")"}]}], "*", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "-", 
           RowBox[{"(", 
            RowBox[{"1", "/", "meanOFF"}], ")"}]}], ")"}], "^", 
         RowBox[{"(", 
          RowBox[{"k", "-", "r"}], ")"}]}]}], ",", "0"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"diffOFFLength", "[", "m_", "]"}], ":=", 
     RowBox[{
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{"Sum", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"fLength", "/.", 
              RowBox[{"k", "\[Rule]", 
               RowBox[{"(", "l", ")"}]}]}], ")"}], "*", 
            RowBox[{"fOFF2", "[", "r", "]"}]}], "/.", 
           RowBox[{"k", "\[Rule]", 
            RowBox[{"(", 
             RowBox[{"l", "+", "n"}], ")"}]}]}], ",", 
          RowBox[{"{", 
           RowBox[{"l", ",", "1", ",", "100"}], "}"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"n", ",", "m", ",", "300"}], "}"}]}], "]"}], "-", 
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{"Sum", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"fLength", "/.", 
              RowBox[{"k", "\[Rule]", 
               RowBox[{"(", "l", ")"}]}]}], ")"}], "*", 
            RowBox[{"fOFF2", "[", 
             RowBox[{"r", "-", "1"}], "]"}]}], "/.", 
           RowBox[{"k", "\[Rule]", 
            RowBox[{"(", 
             RowBox[{"l", "+", "n"}], ")"}]}]}], ",", 
          RowBox[{"{", 
           RowBox[{"l", ",", "1", ",", "100"}], "}"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"n", ",", "m", ",", "300"}], "}"}]}], "]"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"DiscretePlot", "[", 
     RowBox[{
      RowBox[{"diffOFFLength", "[", "0", "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"r", ",", "1", ",", "10"}], "}"}]}], "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{"N", "[", 
       RowBox[{"diffOFFLength", "[", "0", "]"}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"r", ",", "1", ",", "10"}], "}"}]}], "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{"N", "[", 
       RowBox[{
        RowBox[{"diffOFFLength", "[", "0", "]"}], "*", "r"}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"r", ",", "1", ",", "10"}], "}"}]}], "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"N", "[", 
       RowBox[{"diffOFFLength", "[", "0", "]"}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"r", ",", "1", ",", "10"}], "}"}]}], "]"}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"PhiTMGF", "=", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"pLength", "*", 
          RowBox[{"Exp", "[", "z", "]"}]}], ")"}], "/", 
        RowBox[{"(", 
         RowBox[{"1", "-", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "-", "pLength"}], ")"}], "*", 
           RowBox[{"Exp", "[", "z", "]"}]}]}], ")"}]}], ")"}], "*", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"pON", "*", 
           RowBox[{"Exp", "[", "z", "]"}]}], ")"}], "/", 
         RowBox[{"(", 
          RowBox[{"1", "-", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"1", "-", "pON"}], ")"}], "*", 
            RowBox[{"Exp", "[", "z", "]"}]}]}], ")"}]}], ")"}], "^", 
       RowBox[{"(", "kk", ")"}]}]}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"PhiTCF", "=", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"pLength", "*", 
          RowBox[{"Exp", "[", 
           RowBox[{"\[ImaginaryI]", "*", "z"}], "]"}]}], ")"}], "/", 
        RowBox[{"(", 
         RowBox[{"1", "-", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "-", "pLength"}], ")"}], "*", 
           RowBox[{"Exp", "[", 
            RowBox[{"\[ImaginaryI]", "*", "z"}], "]"}]}]}], ")"}]}], ")"}], 
      "*", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"pON", "*", 
           RowBox[{"Exp", "[", 
            RowBox[{"\[ImaginaryI]", "*", "z"}], "]"}]}], ")"}], "/", 
         RowBox[{"(", 
          RowBox[{"1", "-", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"1", "-", "pON"}], ")"}], "*", 
            RowBox[{"Exp", "[", 
             RowBox[{"\[ImaginaryI]", "*", "z"}], "]"}]}]}], ")"}]}], ")"}], 
       "^", 
       RowBox[{"(", "kk", ")"}]}]}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.630754797648471*^9, 3.630754869436593*^9}, {
   3.630754914909664*^9, 3.6307549302016864`*^9}, {3.6307550516679873`*^9, 
   3.630755059402002*^9}, {3.630755212974315*^9, 3.6307552242143307`*^9}, {
   3.630755255556376*^9, 3.630755262246385*^9}, {3.6307554390668173`*^9, 
   3.6307554625288515`*^9}, {3.6307555247789383`*^9, 
   3.6307555591289864`*^9}, {3.630755610259058*^9, 3.6307556458781147`*^9}, 
   3.630755756328446*^9, {3.6307574282061777`*^9, 3.630757432486184*^9}, {
   3.6307580491222258`*^9, 3.630758053932233*^9}, {3.630776757042639*^9, 
   3.630776758256906*^9}, {3.6307772455533323`*^9, 3.630777246993821*^9}, {
   3.6307824320812283`*^9, 3.630782482755789*^9}, {3.6307825965160303`*^9, 
   3.630782598083766*^9}, 3.6307829971694403`*^9, {3.63091633626785*^9, 
   3.6309164387937136`*^9}, {3.630930299436497*^9, 3.6309303133772945`*^9}, 
   3.6314607460437603`*^9, {3.631962752055066*^9, 3.631962799871137*^9}, {
   3.631963381019499*^9, 3.631963381511501*^9}, {3.631963602409797*^9, 
   3.631963607157812*^9}, {3.6319637448336163`*^9, 3.6319637558136315`*^9}, {
   3.632060351660125*^9, 3.632060384016174*^9}, {3.6320604905883245`*^9, 
   3.6320605032243457`*^9}, {3.6320605353043957`*^9, 
   3.6320605514144306`*^9}, {3.632060584349499*^9, 3.6320605977595177`*^9}, {
   3.6320606305136337`*^9, 3.63206063399564*^9}, {3.632126224576282*^9, 
   3.632126225716284*^9}, {3.6321315353763657`*^9, 3.63213153642037*^9}, {
   3.6321322620928783`*^9, 3.632132263892881*^9}, {3.6321329610096793`*^9, 
   3.632132961979681*^9}, {3.632133986919688*^9, 3.6321339891896915`*^9}, {
   3.6321358478818517`*^9, 3.632135849411854*^9}, {3.6324847698034935`*^9, 
   3.6324847708234944`*^9}, {3.6325666886925564`*^9, 
   3.6325666901405687`*^9}, {3.632571282214258*^9, 3.6325712833242598`*^9}, {
   3.6326495417317977`*^9, 3.6326495510618105`*^9}, {3.632657363366277*^9, 
   3.6326573649662876`*^9}, {3.63265943491401*^9, 3.632659438935027*^9}, {
   3.6328117054167604`*^9, 3.6328117144491763`*^9}, {3.6328117510156407`*^9, 
   3.6328117711084757`*^9}, {3.6328120791592307`*^9, 
   3.6328120837300386`*^9}, {3.632823967192435*^9, 3.632823984929666*^9}, {
   3.632826848429226*^9, 3.63282685156923*^9}, {3.634643764435334*^9, 
   3.634643765761337*^9}, {3.635588197239464*^9, 3.635588198721466*^9}, {
   3.6355892122578545`*^9, 3.635589212991056*^9}, {3.635590120574851*^9, 
   3.635590126066061*^9}, {3.635595304405096*^9, 3.6355953068685923`*^9}, {
   3.6355965881682377`*^9, 3.635596598363615*^9}, {3.635601953395358*^9, 
   3.6356019547307053`*^9}, {3.635603433618206*^9, 3.635603435906292*^9}, {
   3.635606167266082*^9, 3.635606172945546*^9}, {3.6356650466341324`*^9, 
   3.6356650550881476`*^9}, {3.6356664291604147`*^9, 
   3.6356664477064466`*^9}, {3.635680422945998*^9, 3.635680425287002*^9}, {
   3.636226026216416*^9, 3.6362260321757507`*^9}, {3.636227378920237*^9, 
   3.6362273842386827`*^9}, {3.63622962084629*^9, 3.636229623354474*^9}, 
   3.636272052246458*^9, {3.636370343623109*^9, 3.636370369947187*^9}, {
   3.6642762091298723`*^9, 3.664276265429348*^9}, {3.664276330576489*^9, 
   3.6642763948598022`*^9}, {3.664276433661497*^9, 3.6642764597632027`*^9}, 
   3.6642773550710506`*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"meanLength", "=", "3"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"meanON", "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"meanOFF", "=", "9"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PQE", "=", 
   RowBox[{"1", "-", "1"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"StartOff", "=", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "-", "PQE"}], ")"}], "*", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"meanOFF", "-", "1"}], ")"}], "/", "meanOFF"}], ")"}]}], "+", 
     RowBox[{"PQE", "*", 
      RowBox[{"(", 
       RowBox[{"meanOFF", "/", 
        RowBox[{"(", 
         RowBox[{"meanOFF", "+", "meanON"}], ")"}]}], ")"}]}]}]}], ";"}], 
  "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"media", "=", 
   RowBox[{"N", "[", 
    RowBox[{
     RowBox[{"StartOff", "*", 
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"diffOFFLength", "[", "0", "]"}], "*", 
          RowBox[{"\[ImaginaryI]", "^", 
           RowBox[{"(", 
            RowBox[{"-", "1"}], ")"}]}], "*", 
          RowBox[{"D", "[", 
           RowBox[{
            RowBox[{"PhiTCF", "/.", 
             RowBox[{"{", 
              RowBox[{"kk", "\[Rule]", 
               RowBox[{"(", 
                RowBox[{"r", "-", "1"}], ")"}]}], "}"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"z", ",", "1"}], "}"}]}], "]"}]}], "/.", 
         RowBox[{"z", "\[Rule]", "0"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"r", ",", "1", ",", "10"}], "}"}]}], "]"}]}], "+", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "-", "StartOff"}], ")"}], "*", 
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"diffOFFLength", "[", "0", "]"}], "*", 
          RowBox[{"\[ImaginaryI]", "^", 
           RowBox[{"(", 
            RowBox[{"-", "1"}], ")"}]}], "*", 
          RowBox[{"D", "[", 
           RowBox[{
            RowBox[{"PhiTCF", "/.", 
             RowBox[{"{", 
              RowBox[{"kk", "\[Rule]", 
               RowBox[{"(", "r", ")"}]}], "}"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"z", ",", "1"}], "}"}]}], "]"}]}], "/.", 
         RowBox[{"z", "\[Rule]", "0"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"r", ",", "1", ",", "10"}], "}"}]}], "]"}]}]}], "]"}]}], 
  "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{"var2", "=", 
   RowBox[{"N", "[", 
    RowBox[{
     RowBox[{"StartOff", "*", 
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"diffOFFLength", "[", "0", "]"}], "*", 
          RowBox[{"\[ImaginaryI]", "^", 
           RowBox[{"(", 
            RowBox[{"-", "2"}], ")"}]}], "*", 
          RowBox[{"D", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"Exp", "[", 
               RowBox[{
                RowBox[{"-", "media"}], "*", "\[ImaginaryI]", "*", "z"}], 
               "]"}], "*", "PhiTCF"}], "/.", 
             RowBox[{"{", 
              RowBox[{"kk", "\[Rule]", 
               RowBox[{"(", 
                RowBox[{"r", "-", "1"}], ")"}]}], "}"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"z", ",", "2"}], "}"}]}], "]"}]}], "/.", 
         RowBox[{"z", "\[Rule]", "0"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"r", ",", "1", ",", "5"}], "}"}]}], "]"}]}], "+", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "-", "StartOff"}], ")"}], "*", 
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"diffOFFLength", "[", "0", "]"}], "*", 
          RowBox[{"\[ImaginaryI]", "^", 
           RowBox[{"(", 
            RowBox[{"-", "2"}], ")"}]}], "*", 
          RowBox[{"D", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"Exp", "[", 
               RowBox[{
                RowBox[{"-", "media"}], "*", "\[ImaginaryI]", "*", "z"}], 
               "]"}], "*", "PhiTCF"}], "/.", 
             RowBox[{"{", 
              RowBox[{"kk", "\[Rule]", 
               RowBox[{"(", "r", ")"}]}], "}"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"z", ",", "2"}], "}"}]}], "]"}]}], "/.", 
         RowBox[{"z", "\[Rule]", "0"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"r", ",", "1", ",", "5"}], "}"}]}], "]"}]}]}], "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.630754797648471*^9, 3.630754869436593*^9}, {
   3.630754914909664*^9, 3.6307549302016864`*^9}, {3.6307550516679873`*^9, 
   3.630755059402002*^9}, {3.630755212974315*^9, 3.6307552242143307`*^9}, {
   3.630755255556376*^9, 3.630755262246385*^9}, {3.6307554390668173`*^9, 
   3.6307554625288515`*^9}, {3.6307555247789383`*^9, 
   3.6307555591289864`*^9}, {3.630755610259058*^9, 3.6307556458781147`*^9}, 
   3.630755756328446*^9, {3.6307574282061777`*^9, 3.630757432486184*^9}, {
   3.6307580491222258`*^9, 3.630758053932233*^9}, {3.630776757042639*^9, 
   3.630776758256906*^9}, {3.6307772455533323`*^9, 3.630777246993821*^9}, {
   3.6307824320812283`*^9, 3.630782482755789*^9}, {3.6307825965160303`*^9, 
   3.630782598083766*^9}, 3.6307829971694403`*^9, {3.63091633626785*^9, 
   3.6309164387937136`*^9}, {3.630930299436497*^9, 3.6309303133772945`*^9}, 
   3.6314607460437603`*^9, {3.631962752055066*^9, 3.631962799871137*^9}, {
   3.631963381019499*^9, 3.631963381511501*^9}, {3.631963602409797*^9, 
   3.631963607157812*^9}, {3.6319637448336163`*^9, 3.6319637558136315`*^9}, {
   3.632060351660125*^9, 3.632060384016174*^9}, {3.6320604905883245`*^9, 
   3.6320605032243457`*^9}, {3.6320605353043957`*^9, 
   3.6320605514144306`*^9}, {3.632060584349499*^9, 3.6320605977595177`*^9}, {
   3.6320606305136337`*^9, 3.63206063399564*^9}, {3.632126224576282*^9, 
   3.632126225716284*^9}, {3.6321315353763657`*^9, 3.63213153642037*^9}, {
   3.6321322620928783`*^9, 3.632132263892881*^9}, {3.6321329610096793`*^9, 
   3.632132961979681*^9}, {3.632133986919688*^9, 3.6321339891896915`*^9}, {
   3.6321358478818517`*^9, 3.632135849411854*^9}, {3.6324847698034935`*^9, 
   3.6324847708234944`*^9}, {3.6325666886925564`*^9, 
   3.6325666901405687`*^9}, {3.632571282214258*^9, 3.6325712833242598`*^9}, {
   3.6326495417317977`*^9, 3.6326495510618105`*^9}, {3.632657363366277*^9, 
   3.6326573649662876`*^9}, {3.63265943491401*^9, 3.632659438935027*^9}, {
   3.6328117054167604`*^9, 3.6328117144491763`*^9}, {3.6328117510156407`*^9, 
   3.6328117711084757`*^9}, {3.6328120791592307`*^9, 
   3.6328120837300386`*^9}, {3.632823967192435*^9, 3.632823984929666*^9}, {
   3.632826848429226*^9, 3.63282685156923*^9}, {3.634643764435334*^9, 
   3.634643765761337*^9}, {3.635588197239464*^9, 3.635588198721466*^9}, {
   3.6355892122578545`*^9, 3.635589212991056*^9}, {3.635590120574851*^9, 
   3.635590126066061*^9}, {3.635595304405096*^9, 3.6355953068685923`*^9}, {
   3.6355965881682377`*^9, 3.635596598363615*^9}, {3.635601953395358*^9, 
   3.6356019547307053`*^9}, {3.635603433618206*^9, 3.635603435906292*^9}, {
   3.635606167266082*^9, 3.635606172945546*^9}, {3.6356650466341324`*^9, 
   3.6356650550881476`*^9}, {3.6356664291604147`*^9, 
   3.6356664477064466`*^9}, {3.635680422945998*^9, 3.635680425287002*^9}, {
   3.636226026216416*^9, 3.6362260321757507`*^9}, {3.636227378920237*^9, 
   3.6362273842386827`*^9}, {3.63622962084629*^9, 3.636229623354474*^9}, {
   3.636272052246458*^9, 3.636272131898584*^9}, {3.636357622191661*^9, 
   3.6363576305237103`*^9}, 3.636357767258712*^9, {3.6363583976573563`*^9, 
   3.636358406707369*^9}, {3.6642764767820597`*^9, 3.6642764775179653`*^9}, {
   3.664277144239477*^9, 3.6642771460311823`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"meanLength", "=", "3"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"meanON", "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"meanOFF", "=", "9"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"lambda", "=", 
    RowBox[{"List", "[", 
     RowBox[{
      RowBox[{"1", "/", "32"}], ",", 
      RowBox[{"1", "/", "16.5"}], ",", 
      RowBox[{"1", "/", "11"}], ",", 
      RowBox[{"1", "/", "8.4"}], ",", 
      RowBox[{"1", "/", "6.7"}], ",", 
      RowBox[{"1", "/", "5.5"}], ",", 
      RowBox[{"1", "/", "4.75"}], ",", 
      RowBox[{"1", "/", "4.15"}], ",", 
      RowBox[{"1", "/", "3.7"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"MeanQueueLength", "=", 
     RowBox[{"List", "[", 
      RowBox[{
      "0.1152", ",", "0.2531", ",", "0.4294", ",", "0.6304", ",", "0.9520", 
       ",", "1.4871", ",", "2.2643", ",", "4.1521", ",", "9.0662"}], "]"}]}], 
    ";"}], "*)"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"For", "[", 
  RowBox[{
   RowBox[{"i", "=", "1"}], ",", 
   RowBox[{"i", "\[LessEqual]", "9"}], ",", 
   RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Clear", "[", 
     RowBox[{
     "StartOff", ",", "PhiTPond", ",", "PPQueue", ",", "Sol1", ",", "mu", ",",
       "PQE", ",", "VarMu"}], "]"}], ";", "\[IndentingNewLine]", 
    "\[IndentingNewLine]", 
    RowBox[{"Ro", "=", 
     RowBox[{
      RowBox[{"lambda", "[", 
       RowBox[{"[", "i", "]"}], "]"}], "/", 
      RowBox[{"(", 
       RowBox[{"1", "/", "mu"}], ")"}]}]}], ";", "\[IndentingNewLine]", 
    "\[IndentingNewLine]", 
    RowBox[{"StartOff", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "-", "PQE"}], ")"}], "*", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"meanOFF", "-", "1"}], ")"}], "/", "meanOFF"}], ")"}]}], 
      "+", 
      RowBox[{"PQE", "*", 
       RowBox[{"(", 
        RowBox[{"meanOFF", "/", 
         RowBox[{"(", 
          RowBox[{"meanOFF", "+", "meanON"}], ")"}]}], ")"}]}]}]}], ";", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"PhiTPondMGF", "=", 
     RowBox[{
      RowBox[{"StartOff", "*", 
       RowBox[{"Sum", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"diffOFFLength", "[", "0", "]"}], "*", "PhiTMGF"}], "/.", 
          RowBox[{"{", 
           RowBox[{"kk", "\[Rule]", 
            RowBox[{"(", 
             RowBox[{"r", "-", "1"}], ")"}]}], "}"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"r", ",", "1", ",", "10"}], "}"}]}], "]"}]}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "-", "StartOff"}], ")"}], "*", 
       RowBox[{"Sum", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"diffOFFLength", "[", "0", "]"}], "*", "PhiTMGF"}], "/.", 
          RowBox[{"{", 
           RowBox[{"kk", "\[Rule]", 
            RowBox[{"(", "r", ")"}]}], "}"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"r", ",", "1", ",", "10"}], "}"}]}], "]"}]}]}]}], ";", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"PPQueue", "=", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "-", "z"}], ")"}], "*", 
        RowBox[{"(", 
         RowBox[{"1", "-", "Ro"}], ")"}], "*", 
        RowBox[{"(", 
         RowBox[{"PhiTPondMGF", "/.", 
          RowBox[{"z", "\[Rule]", 
           RowBox[{
            RowBox[{"-", 
             RowBox[{"lambda", "[", 
              RowBox[{"[", "i", "]"}], "]"}]}], "+", 
            RowBox[{
             RowBox[{"lambda", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "*", "z"}]}]}]}], ")"}]}], 
       ")"}], "/", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "z"}], "+", 
        RowBox[{"(", 
         RowBox[{"PhiTPondMGF", "/.", 
          RowBox[{"z", "\[Rule]", 
           RowBox[{
            RowBox[{"-", 
             RowBox[{"lambda", "[", 
              RowBox[{"[", "i", "]"}], "]"}]}], "+", 
            RowBox[{
             RowBox[{"lambda", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "*", "z"}]}]}]}], ")"}]}], 
       ")"}]}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"Sol1", "=", 
     RowBox[{"Solve", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"PQE", "\[Equal]", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"D", "[", 
             RowBox[{"PPQueue", ",", 
              RowBox[{"{", 
               RowBox[{"z", ",", "0"}], "}"}]}], "]"}], "/.", 
            RowBox[{"z", "\[Rule]", "0"}]}], ")"}], "/", 
          RowBox[{"(", 
           RowBox[{"0", "!"}], ")"}]}]}], "&&", 
        RowBox[{"mu", "\[Equal]", 
         RowBox[{"(", 
          RowBox[{"N", "[", 
           RowBox[{
            RowBox[{"StartOff", "*", 
             RowBox[{"Sum", "[", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"diffOFFLength", "[", "0", "]"}], "*", 
                 RowBox[{"\[ImaginaryI]", "^", 
                  RowBox[{"(", 
                   RowBox[{"-", "1"}], ")"}]}], "*", 
                 RowBox[{"D", "[", 
                  RowBox[{
                   RowBox[{"PhiTCF", "/.", 
                    RowBox[{"{", 
                    RowBox[{"kk", "\[Rule]", 
                    RowBox[{"(", 
                    RowBox[{"r", "-", "1"}], ")"}]}], "}"}]}], ",", 
                   RowBox[{"{", 
                    RowBox[{"z", ",", "1"}], "}"}]}], "]"}]}], "/.", 
                RowBox[{"z", "\[Rule]", "0"}]}], ",", 
               RowBox[{"{", 
                RowBox[{"r", ",", "1", ",", "10"}], "}"}]}], "]"}]}], "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"1", "-", "StartOff"}], ")"}], "*", 
             RowBox[{"Sum", "[", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"diffOFFLength", "[", "0", "]"}], "*", 
                 RowBox[{"\[ImaginaryI]", "^", 
                  RowBox[{"(", 
                   RowBox[{"-", "1"}], ")"}]}], "*", 
                 RowBox[{"D", "[", 
                  RowBox[{
                   RowBox[{"PhiTCF", "/.", 
                    RowBox[{"{", 
                    RowBox[{"kk", "\[Rule]", 
                    RowBox[{"(", "r", ")"}]}], "}"}]}], ",", 
                   RowBox[{"{", 
                    RowBox[{"z", ",", "1"}], "}"}]}], "]"}]}], "/.", 
                RowBox[{"z", "\[Rule]", "0"}]}], ",", 
               RowBox[{"{", 
                RowBox[{"r", ",", "1", ",", "10"}], "}"}]}], "]"}]}]}], "]"}],
           ")"}]}], "&&", 
        RowBox[{"1", "\[GreaterEqual]", "PQE", "\[GreaterEqual]", "0"}], "&&", 
        RowBox[{"mu", ">", "0"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"PQE", ",", "mu"}], "}"}]}], "]"}]}], ";", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"VarMu", "=", 
     RowBox[{"N", "[", 
      RowBox[{
       RowBox[{"StartOff", "*", 
        RowBox[{"Sum", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"diffOFFLength", "[", "0", "]"}], "*", 
            RowBox[{"\[ImaginaryI]", "^", 
             RowBox[{"(", 
              RowBox[{"-", "2"}], ")"}]}], "*", 
            RowBox[{"D", "[", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"Exp", "[", 
                 RowBox[{
                  RowBox[{"-", "mu"}], "*", "\[ImaginaryI]", "*", "z"}], 
                 "]"}], "*", "PhiTCF"}], "/.", 
               RowBox[{"{", 
                RowBox[{"kk", "\[Rule]", 
                 RowBox[{"(", 
                  RowBox[{"r", "-", "1"}], ")"}]}], "}"}]}], ",", 
              RowBox[{"{", 
               RowBox[{"z", ",", "2"}], "}"}]}], "]"}]}], "/.", 
           RowBox[{"z", "\[Rule]", "0"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"r", ",", "1", ",", "10"}], "}"}]}], "]"}]}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "-", "StartOff"}], ")"}], "*", 
        RowBox[{"Sum", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"diffOFFLength", "[", "0", "]"}], "*", 
            RowBox[{"\[ImaginaryI]", "^", 
             RowBox[{"(", 
              RowBox[{"-", "2"}], ")"}]}], "*", 
            RowBox[{"D", "[", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"Exp", "[", 
                 RowBox[{
                  RowBox[{"-", "mu"}], "*", "\[ImaginaryI]", "*", "z"}], 
                 "]"}], "*", "PhiTCF"}], "/.", 
               RowBox[{"{", 
                RowBox[{"kk", "\[Rule]", 
                 RowBox[{"(", "r", ")"}]}], "}"}]}], ",", 
              RowBox[{"{", 
               RowBox[{"z", ",", "2"}], "}"}]}], "]"}]}], "/.", 
           RowBox[{"z", "\[Rule]", "0"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"r", ",", "1", ",", "10"}], "}"}]}], "]"}]}]}], "]"}]}], 
    ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"mu", "=", 
     RowBox[{"mu", "/.", 
      RowBox[{"Sol1", "[", 
       RowBox[{"[", "1", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"PQE", "=", 
     RowBox[{"PQE", "/.", 
      RowBox[{"Sol1", "[", 
       RowBox[{"[", "1", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
    "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{
      RowBox[{"MeanQueueLength", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"Sum", "[", 
          RowBox[{
           RowBox[{"k", "*", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"D", "[", 
                RowBox[{"PPQueue", ",", 
                 RowBox[{"{", 
                  RowBox[{"z", ",", "k"}], "}"}]}], "]"}], "/.", 
               RowBox[{"z", "\[Rule]", "0"}]}], ")"}], "/", 
             RowBox[{"(", 
              RowBox[{"k", "!"}], ")"}]}]}], ",", 
           RowBox[{"{", 
            RowBox[{"k", ",", "1", ",", "20"}], "}"}]}], "]"}], 
         "\[IndentingNewLine]", "W"}], "=", 
        RowBox[{
         RowBox[{"Ro", "*", "mu"}], "+", 
         RowBox[{
          RowBox[{"MeanQueueLength", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "*", "mu"}]}]}]}], ";"}], "*)"}], 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"W", "=", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"lambda", "[", 
         RowBox[{"[", "i", "]"}], "]"}], "*", 
        RowBox[{"(", 
         RowBox[{"VarMu", "+", 
          RowBox[{"mu", "^", "2"}]}], ")"}]}], ")"}], "/", 
      RowBox[{"(", 
       RowBox[{"2", "-", 
        RowBox[{"2", "*", "Ro"}]}], ")"}]}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"Q", "=", 
     RowBox[{
      RowBox[{"lambda", "[", 
       RowBox[{"[", "i", "]"}], "]"}], "*", 
      RowBox[{"(", 
       RowBox[{"W", "+", "mu"}], ")"}]}]}], ";", "\[IndentingNewLine]", 
    "\[IndentingNewLine]", 
    RowBox[{"Print", "[", "Q", "]"}], ";", "\[IndentingNewLine]", 
    RowBox[{"Print", "[", "W", "]"}], ";", "\[IndentingNewLine]", 
    RowBox[{"Print", "[", "mu", "]"}], ";"}]}], "\[IndentingNewLine]", 
  "]"}]}], "Input",
 CellChangeTimes->{{3.6328121308431215`*^9, 3.6328121383935347`*^9}, {
   3.632812221947282*^9, 3.6328122277036915`*^9}, {3.6328122763133774`*^9, 
   3.6328122908370028`*^9}, {3.632812567031489*^9, 3.6328125699642944`*^9}, {
   3.6328127317365785`*^9, 3.63281273268818*^9}, {3.6328137301963396`*^9, 
   3.6328137331135445`*^9}, {3.6328162090342817`*^9, 3.632816216927896*^9}, {
   3.6328239210153537`*^9, 3.6328239391113853`*^9}, {3.632823969516839*^9, 
   3.63282398152886*^9}, {3.6328241265935144`*^9, 3.6328241292455196`*^9}, {
   3.6328246907762613`*^9, 3.632824704083085*^9}, {3.632824768511198*^9, 
   3.6328248172456837`*^9}, {3.6328248784289913`*^9, 
   3.6328248889746094`*^9}, {3.6328249776919656`*^9, 
   3.6328250626497145`*^9}, {3.632825149526272*^9, 3.632825152771077*^9}, {
   3.6328261035741596`*^9, 3.632826106070168*^9}, {3.632831333005905*^9, 
   3.6328313370775127`*^9}, {3.63387663222635*^9, 3.633876635114623*^9}, {
   3.6338766717646923`*^9, 3.633876698448008*^9}, {3.634465262543187*^9, 
   3.6344652963233137`*^9}, {3.6344657376789665`*^9, 3.634465779492339*^9}, {
   3.634467446570962*^9, 3.634467449382967*^9}, {3.6344675927833924`*^9, 
   3.6344676239554434`*^9}, 3.6344677947637014`*^9, {3.6344701821473465`*^9, 
   3.6344701833104134`*^9}, {3.634643750972511*^9, 3.634643753952116*^9}, {
   3.635587854253261*^9, 3.635587857544867*^9}, {3.6355892029446383`*^9, 
   3.635589203287839*^9}, {3.6355892428495083`*^9, 3.6355892450647125`*^9}, {
   3.635589310339227*^9, 3.6355893281856585`*^9}, {3.6355893616663175`*^9, 
   3.6355893871879625`*^9}, {3.635590139747285*^9, 3.635590163022526*^9}, {
   3.6356007886983137`*^9, 3.635600807337199*^9}, {3.635665889545784*^9, 
   3.6356659232198586`*^9}, 3.635666117079152*^9, {3.6356663932883606`*^9, 
   3.6356664012603755`*^9}, {3.6356664733864937`*^9, 
   3.6356665348106127`*^9}, {3.6356668643133554`*^9, 3.635666865757368*^9}, {
   3.6356670095047607`*^9, 3.6356670114947634`*^9}, {3.63566744219705*^9, 
   3.635667447617058*^9}, {3.635667709359726*^9, 3.635667724661748*^9}, {
   3.635671456898037*^9, 3.6356715014635344`*^9}, 3.635672195871358*^9, {
   3.6363706393217287`*^9, 3.6363706698837833`*^9}, {3.636370900951384*^9, 
   3.636370909201412*^9}, {3.6363714671213293`*^9, 3.636371482081351*^9}, {
   3.6363754261520457`*^9, 3.6363754658401146`*^9}, {3.6363755045602665`*^9, 
   3.6363755048602667`*^9}, {3.6363758953068557`*^9, 3.6363758974168587`*^9}, 
   3.6363778993200903`*^9, {3.636398273062705*^9, 3.636398280381673*^9}, {
   3.636398989447277*^9, 3.6363990113255453`*^9}, 3.6363992290103703`*^9, {
   3.6364005891250153`*^9, 3.63640059091568*^9}, {3.6364010638373938`*^9, 
   3.636401064659247*^9}, {3.6364037432136393`*^9, 3.636403745053388*^9}, {
   3.6364418901872005`*^9, 3.636441899107213*^9}, {3.636441937859269*^9, 
   3.636442104820527*^9}, {3.636442138644577*^9, 3.6364421967066727`*^9}, {
   3.6364422324937353`*^9, 3.6364423196099267`*^9}, 3.636442567782583*^9, {
   3.636450214497547*^9, 3.636450226759169*^9}, {3.636452819225774*^9, 
   3.636452846104621*^9}, {3.6364530323407545`*^9, 3.6364530364591618`*^9}, {
   3.6364530751628294`*^9, 3.636453142118147*^9}, {3.6364534640601163`*^9, 
   3.6364534853385534`*^9}, {3.63645661106426*^9, 3.6364566467581224`*^9}, {
   3.636456726522063*^9, 3.6364567659433317`*^9}, {3.640001076907683*^9, 
   3.640001095823739*^9}, {3.6400016177756166`*^9, 3.6400016195756187`*^9}, {
   3.6400040374049835`*^9, 3.6400040818550453`*^9}, {3.640006594801589*^9, 
   3.640006646692557*^9}, {3.64001487256985*^9, 3.640014907674011*^9}, {
   3.640070851820922*^9, 3.640070887745204*^9}, {3.640076242352421*^9, 
   3.6400762770704746`*^9}, {3.6400788040960436`*^9, 
   3.6400788153436637`*^9}, {3.6400788614729443`*^9, 
   3.6400788826577816`*^9}, {3.640084338535821*^9, 3.6400843925909157`*^9}}]
},
WindowSize->{704, 780},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
PrivateNotebookOptions->{"VersionedStylesheet"->{"Default.nb"[8.] -> False}},
Magnification:>0.9 Inherited,
FrontEndVersion->"10.0 for Mac OS X x86 (32-bit, 64-bit Kernel) (June 27, \
2014)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[557, 20, 12076, 306, 582, "Input"],
Cell[12636, 328, 7743, 177, 357, "Input"],
Cell[20382, 507, 15066, 359, 777, "Input"]
}
]
*)

(* End of internal cache information *)
